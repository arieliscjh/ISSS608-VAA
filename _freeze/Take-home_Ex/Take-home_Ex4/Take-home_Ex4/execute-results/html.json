{
  "hash": "675b0e13cc3d118be16d0f83bc8dacfa",
  "result": {
    "markdown": "---\ntitle: \"Univariate & Bivariate Analysis\"\ndate: \"March 8,2024\"\ndate-modified: \"last-modified\"\nexecute: \n  echo: true\n  warning: false\n  freeze: true\neditor: visual\nauthor: Chen Jinghan\n---\n\n\n# Univariate & Bivariate Analysis\n\n# 1. Overview\n\nIn this analysis, it will be break into two parts:\n\n-   General visualization of student profile who fill in the questionnaire\n\n-   EDA & CDA of related possible influential factors on students academic performance\n\n# 2. Loading R package\n\n\n::: {.cell}\n\n```{.r .cell-code}\npacman::p_load(tidyverse, haven, patchwork,ggrepel,ggthemes, ggstatsplot, ggplot2, ggridges, performance, ggiraph)\n```\n:::\n\n\n# 3. Import data\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndataset_filtered <- read.csv(\"data/stu_SG_filtered.csv\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndataset <- read.csv(\"data/stu_SG_rcd.csv\")\n```\n:::\n\n\n# 4. Univariate Analysis\n\n## 4.1 Student Profile: *Know more about our participants*\n\n### 4.1.1 Gender\n\npie chart for gender, school type, home language\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndataset_gender <- dataset %>%\n  count(Gender)\n\ndataset_gender <- dataset_gender %>% \n  mutate(prop = n / sum(dataset_gender$n) *100,\n         n_pct = paste0(round(prop,2),\"%\"),\n         ypos = cumsum(prop)- 0.5*prop,\n         ypos_pct = case_when(ypos > 50 ~ ypos-4, ypos<= 50 ~ ypos+4)) \n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(dataset_gender, aes(x=\"\", y=prop, fill=Gender)) +\n  geom_bar(stat=\"identity\", width=1) +\n  coord_polar(\"y\", start=0) +\n  theme_void() + \n  geom_text(aes(y = ypos, label = n), color = \"white\", size=3) +\n  geom_text(aes(y = ypos_pct, label = n_pct), color = \"black\", size=3)\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex4_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\n### 4.1.2 School Type\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndataset_SchoolType <- dataset %>%\n  count(SchoolType)\n\ndataset_SchoolType <- dataset_SchoolType %>% \n  mutate(prop = n / sum(dataset_SchoolType$n) *100,\n         n_pct = paste0(round(prop,2),\"%\"),\n         ypos = cumsum(prop)- 0.5*prop,\n         ypos_pct = case_when(ypos > 100 ~ ypos-6, ypos<= 100 ~ ypos+6)) \n\nggplot(dataset_SchoolType, aes(x=\"\", y=prop, fill=SchoolType)) +\n  geom_bar(stat=\"identity\", width=1) +\n  coord_polar(\"y\", start=0) +\n  theme_void() + \n  geom_text(aes(y = ypos, label = n), color = \"white\", size=3) +\n  geom_text(aes(y = ypos_pct, label = n_pct), color = \"black\", size=3)\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex4_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\n### 4.1.3 Home Language \n\n\n::: {.cell}\n\n```{.r .cell-code}\ndataset_HomeLanguage <- dataset %>%\n  count(HomeLanguage)\n\ndataset_HomeLanguage <- dataset_HomeLanguage %>% \n  mutate(prop = n / sum(dataset_HomeLanguage$n) *100,\n         n_pct = paste0(round(prop,2),\"%\"),\n         ypos = cumsum(prop)- 0.5*prop,\n         ypos_pct = case_when(ypos > 10 ~ ypos-5, ypos<= 10 ~ ypos+5)) \n\nggplot(dataset_HomeLanguage, aes(x=\"\", y=prop, fill=HomeLanguage)) +\n  geom_bar(stat=\"identity\", width=1) +\n  coord_polar(\"y\", start=0) +\n  theme_void() + \n  geom_text(aes(y = ypos, label = n), color = \"white\", size=3) +\n  geom_text(aes(y = ypos_pct, label = n_pct), color = \"black\", size=3)\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex4_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\n### 4.1.3 Immigration\n\nbar chart for immigration, siblings, parents education\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = dataset,\n       aes(x = Immigration)) +\n  geom_bar() +\ngeom_text(stat=\"count\", \n      aes(label=paste0(stat(count), \", \", \n      round(after_stat(count)/sum(after_stat(count))*100, 1), \"%\")),\n      vjust=-0.5,\n      size=3) +\n    labs(x = \"\",\n         y = \"\",\n         title = \"Immigration\") + \n    theme(\n      plot.title = element_text(size=9, face=\"bold\"),\n      panel.grid = element_blank(), \n      axis.text.y = element_blank(),\n      axis.title.y = element_blank(),\n      axis.ticks.y = element_blank(),   \n      axis.ticks.x = element_blank(),      \n      plot.background=element_rect(fill=\"white\",colour=\"white\")\n    ) \n```\n\n::: {.cell-output-display}\n![](Take-home_Ex4_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\n### 4.1.3 Siblings\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = dataset,\n       aes(x = Sibling)) +\n  geom_bar() +\ngeom_text(stat=\"count\", \n      aes(label=paste0(stat(count), \", \", \n      round(after_stat(count)/sum(after_stat(count))*100, 1), \"%\")),\n      vjust=-0.5,\n      size=3) +\n    labs(x = \"\",\n         y = \"\",\n         title = \"Siblings\") + \n    theme(\n      plot.title = element_text(size=9, face=\"bold\"),\n      panel.grid = element_blank(), \n      axis.text.y = element_blank(),\n      axis.title.y = element_blank(),\n      axis.ticks.y = element_blank(),   \n      axis.ticks.x = element_blank(),      \n      plot.background=element_rect(fill=\"white\",colour=\"white\")\n    ) \n```\n\n::: {.cell-output-display}\n![](Take-home_Ex4_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n\n### 4.1.3 Parents Education\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = dataset,\n       aes(x = ParentsEducation)) +\n  geom_bar() +\ngeom_text(stat=\"count\", \n      aes(label=paste0(stat(count), \", \", \n      round(after_stat(count)/sum(after_stat(count))*100, 1), \"%\")),\n      vjust=-0.5,\n      size=3) +\n    labs(x = \"\",\n         y = \"\",\n         title = \"ParentsEducation\") + \n    theme(\n      plot.title = element_text(size=9, face=\"bold\"),\n      panel.grid = element_blank(), \n      axis.text.y = element_blank(),\n      axis.title.y = element_blank(),\n      axis.ticks.y = element_blank(),   \n      axis.ticks.x = element_blank(),      \n      plot.background=element_rect(fill=\"white\",colour=\"white\")\n    ) \n```\n\n::: {.cell-output-display}\n![](Take-home_Ex4_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n\n## 4.2 Academic performance\n\n### 4.2.1 Math\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# min, max, mean, median of the score \nmath_mean <- round(mean(dataset$Math),0)\nmath_median <- round(median(dataset$Math),0)\nmath_min <- round(min(dataset$Math),0)\nmath_max <- round(max(dataset$Math),0)\nleftwhisk_math <- round(quantile(dataset$Math, probs = .25)-1.5*IQR(dataset$Math),0)\n\nmath_distribution <- \n  ggplot(\n    dataset, \n    aes(x = Math)\n  ) +\n  geom_histogram(\n    bins = 25,\n    color = \"#f5f5f5\",\n    fill=\"#c7c8cc\"\n  ) +\n  scale_x_continuous(\n    breaks = scales::pretty_breaks(n = 5), \n    limits = c(150,950),) +\n  geom_vline(\n    aes(xintercept = math_median),\n    colour=\"#595DE5\", \n    linewidth = 0.7, \n    linetype = \"dashed\"\n  ) +\n  annotate(\n    geom = \"text\", \n    x = 660, \n    y = 870,\n    label = paste0(\"Median = \", math_median),\n    color=\"#595DE5\"\n  ) +\n  geom_vline(\n    aes(xintercept = math_mean),\n    colour=\"#e0218a\", \n    linewidth = 0.7, \n    linetype = \"dashed\"\n  ) +\n  annotate(\n    geom = \"text\", \n    x = 535, \n    y = 870,\n    label = paste0(\"Mean = \", math_mean),\n    color=\"#e0218a\"\n  ) +  \n  labs(x = NULL, y = NULL\n  ) +\n  theme_minimal() +\n  theme(\n    axis.text.y = element_blank(),\n    panel.grid.major = element_blank(),\n    plot.background = element_rect(fill=\"#f5f5f5\",colour=\"#f5f5f5\")\n  )\n\n# Boxplot\nbox_math <- \n  ggplot(\n    dataset, \n    aes(y = Math, x=\"\")\n  ) + \n  geom_boxplot(\n    fill=\"#c7c8cc\",\n    outlier.colour=\"#d18a7d\", \n    outlier.shape=16,\n    outlier.size=1, \n    notch=FALSE\n  ) + \n  stat_summary(geom = 'point',\n               fun.y='mean',\n               colour = '#e0218a',\n               size=4) +\n  coord_flip() + \n  \n    #Annotate with amounts to show range\n  annotate(\n    geom = \"text\", \n    x = 0.5, \n    y = math_min,\n    label = paste0(math_min),\n    color = \"#d18a7d\"\n  ) + \n   annotate(\n    geom = \"text\", \n    x = 0.5, \n    y = leftwhisk_math,\n    label = paste0(leftwhisk_math),\n    color = \"#34414E\"\n  ) +\n  annotate(\n    geom = \"text\", \n    x = 0.5, \n    y = math_max,\n    label = paste0(math_max),\n    color = \"#34414E\"\n  ) + \n  \n  labs(\n    title = \"Distribution of Math Scores Performance\",\n     y = \"\", \n    x = \"\"\n  ) + \n   scale_y_continuous(\n    limits = c(150,950), \n  ) +\n  \n  stat_boxplot(\n    geom=\"errorbar\", \n    width=0.5\n  ) + \n  theme_minimal() +\n  theme(\n    axis.text = element_blank(), \n    axis.ticks = element_blank(),\n    panel.grid.major = element_blank(),\n     plot.background = element_rect(\n       fill=\"#f5f5f5\",colour=\"#f5f5f5\")\n  )\n\nhbox_math <- (box_math / math_distribution) + \n        plot_layout(heights = c(1, 2.5))\n\nhbox_math & theme_void()\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex4_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n\n### 4.2.2 Reading\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# min, max, mean, median of the score \nReading_mean <- round(mean(dataset$Reading),0)\nReading_median <- round(median(dataset$Reading),0)\nReading_min <- round(min(dataset$Reading),0)\nReading_max <- round(max(dataset$Reading),0)\nleftwhisk_Reading <- round(quantile(dataset$Reading, probs = .25)-1.5*IQR(dataset$Reading),0)\n\nReading_distribution <- \n  ggplot(\n    dataset, \n    aes(x = Reading)\n  ) +\n  geom_histogram(\n    bins = 25,\n    color = \"#f5f5f5\",\n    fill=\"#c7c8cc\"\n  ) +\n  scale_x_continuous(\n    breaks = scales::pretty_breaks(n = 5), \n    limits = c(150,950),) +\n  geom_vline(\n    aes(xintercept = Reading_median),\n    colour=\"#595DE5\", \n    linewidth = 0.7, \n    linetype = \"dashed\"\n  ) +\n  annotate(\n    geom = \"text\", \n    x = 660, \n    y = 870,\n    label = paste0(\"Median = \", Reading_median),\n    color=\"#595DE5\"\n  ) +\n  geom_vline(\n    aes(xintercept = Reading_mean),\n    colour=\"#e0218a\", \n    linewidth = 0.7, \n    linetype = \"dashed\"\n  ) +\n  annotate(\n    geom = \"text\", \n    x = 535, \n    y = 870,\n    label = paste0(\"Mean = \", Reading_mean),\n    color=\"#e0218a\"\n  ) +  \n  labs(x = NULL, y = NULL\n  ) +\n  theme_minimal() +\n  theme(\n    axis.text.y = element_blank(),\n    panel.grid.major = element_blank(),\n    plot.background = element_rect(fill=\"#f5f5f5\",colour=\"#f5f5f5\")\n  )\n\n# Boxplot\nbox_Reading <- \n  ggplot(\n    dataset, \n    aes(y = Reading, x=\"\")\n  ) + \n  geom_boxplot(\n    fill=\"#c7c8cc\",\n    outlier.colour=\"#d18a7d\", \n    outlier.shape=16,\n    outlier.size=1, \n    notch=FALSE\n  ) + \n  stat_summary(geom = 'point',\n               fun.y='mean',\n               colour = '#e0218a',\n               size=4) +\n  coord_flip() + \n  \n    #Annotate with amounts to show range\n  annotate(\n    geom = \"text\", \n    x = 0.5, \n    y = Reading_min,\n    label = paste0(Reading_min),\n    color = \"#d18a7d\"\n  ) + \n   annotate(\n    geom = \"text\", \n    x = 0.5, \n    y = leftwhisk_Reading,\n    label = paste0(leftwhisk_Reading),\n    color = \"#34414E\"\n  ) +\n  annotate(\n    geom = \"text\", \n    x = 0.5, \n    y = Reading_max,\n    label = paste0(Reading_max),\n    color = \"#34414E\"\n  ) + \n  \n  labs(\n    title = \"Distribution of Reading Scores Performance\",\n     y = \"\", \n    x = \"\"\n  ) + \n   scale_y_continuous(\n    limits = c(150,950), \n  ) +\n  \n  stat_boxplot(\n    geom=\"errorbar\", \n    width=0.5\n  ) + \n  theme_minimal() +\n  theme(\n    axis.text = element_blank(), \n    axis.ticks = element_blank(),\n    panel.grid.major = element_blank(),\n     plot.background = element_rect(\n       fill=\"#f5f5f5\",colour=\"#f5f5f5\")\n  )\n\nhbox_Reading <- (box_Reading / Reading_distribution) + \n        plot_layout(heights = c(1, 2.5))\n\nhbox_Reading & theme_void()\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex4_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n:::\n\n\n### 4.2.3 Science \n\n\n::: {.cell}\n\n```{.r .cell-code}\n# min, max, mean, median of the score \nScience_mean <- round(mean(dataset$Science),0)\nScience_median <- round(median(dataset$Science),0)\nScience_min <- round(min(dataset$Science),0)\nScience_max <- round(max(dataset$Science),0)\nleftwhisk_Science <- round(quantile(dataset$Science, probs = .25)-1.5*IQR(dataset$Science),0)\n\nScience_distribution <- \n  ggplot(\n    dataset, \n    aes(x = Science)\n  ) +\n  geom_histogram(\n    bins = 25,\n    color = \"#f5f5f5\",\n    fill=\"#c7c8cc\"\n  ) +\n  scale_x_continuous(\n    breaks = scales::pretty_breaks(n = 5), \n    limits = c(150,950),) +\n  geom_vline(\n    aes(xintercept = Science_median),\n    colour=\"#595DE5\", \n    linewidth = 0.7, \n    linetype = \"dashed\"\n  ) +\n  annotate(\n    geom = \"text\", \n    x = 660, \n    y = 870,\n    label = paste0(\"Median = \", Science_median),\n    color=\"#595DE5\"\n  ) +\n  geom_vline(\n    aes(xintercept = Science_mean),\n    colour=\"#e0218a\", \n    linewidth = 0.7, \n    linetype = \"dashed\"\n  ) +\n  annotate(\n    geom = \"text\", \n    x = 535, \n    y = 870,\n    label = paste0(\"Mean = \", Science_mean),\n    color=\"#e0218a\"\n  ) +  \n  labs(x = NULL, y = NULL\n  ) +\n  theme_minimal() +\n  theme(\n    axis.text.y = element_blank(),\n    panel.grid.major = element_blank(),\n    plot.background = element_rect(fill=\"#f5f5f5\",colour=\"#f5f5f5\")\n  )\n\n# Boxplot\nbox_Science <- \n  ggplot(\n    dataset, \n    aes(y = Science, x=\"\")\n  ) + \n  geom_boxplot(\n    fill=\"#c7c8cc\",\n    outlier.colour=\"#d18a7d\", \n    outlier.shape=16,\n    outlier.size=1, \n    notch=FALSE\n  ) + \n  stat_summary(geom = 'point',\n               fun.y='mean',\n               colour = '#e0218a',\n               size=4) +\n  coord_flip() + \n  \n    #Annotate with amounts to show range\n  annotate(\n    geom = \"text\", \n    x = 0.5, \n    y = Science_min,\n    label = paste0(Science_min),\n    color = \"#d18a7d\"\n  ) + \n   annotate(\n    geom = \"text\", \n    x = 0.5, \n    y = leftwhisk_Science,\n    label = paste0(leftwhisk_Science),\n    color = \"#34414E\"\n  ) +\n  annotate(\n    geom = \"text\", \n    x = 0.5, \n    y = Science_max,\n    label = paste0(Science_max),\n    color = \"#34414E\"\n  ) + \n  \n  labs(\n    title = \"Distribution of Science Scores Performance\",\n     y = \"\", \n    x = \"\"\n  ) + \n   scale_y_continuous(\n    limits = c(150,950), \n  ) +\n  \n  stat_boxplot(\n    geom=\"errorbar\", \n    width=0.5\n  ) + \n  theme_minimal() +\n  theme(\n    axis.text = element_blank(), \n    axis.ticks = element_blank(),\n    panel.grid.major = element_blank(),\n     plot.background = element_rect(\n       fill=\"#f5f5f5\",colour=\"#f5f5f5\")\n  )\n\nhbox_Science <- (box_Science / Science_distribution) + \n        plot_layout(heights = c(1, 2.5))\n\nhbox_Science & theme_void()\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex4_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n:::\n\n\n# 5. Bivariate Analysis\n\n## 5.1 Time spend on homework & Academic performance\n\n### 5.1.1 Distribution\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(\n    dataset, \n    aes(x = Math, \n        y = Homework_Math,\n        fill = Homework_Math,\n        color = Homework_Math)\n  ) +\n  geom_density_ridges(\n    # Adjust bandwidth to reveal variations \n    bandwidth = 15,\n    alpha = .6\n  ) +\n  labs(\n    title = \"Distribution of Math Score Across Time Length Spend on Math Homework\"\n  ) +\n  theme(\n    legend.position = \"none\",\n    axis.title.y = element_blank(),\n    panel.grid.major = element_blank(),\n    plot.background = element_rect(fill=\"white\",colour=\"white\")\n  )\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex4_files/figure-html/unnamed-chunk-14-1.png){width=672}\n:::\n:::\n\n\n### 5.1.2 Normality Test\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmodel1 <- lm(Math ~ Homework_Math, data = dataset)\ncheck_n <- check_normality(model1)\nplot(check_n)\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex4_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n:::\n\n\n### 5.1.3 ANOVA\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggbetweenstats(\n  data = dataset,\n  x = Homework_Math, \n  y = Math,\n  type = \"non-parametric\",\n  mean.ci = TRUE, \n  pairwise.comparisons = TRUE, \n  pairwise.display = \"s\",\n  p.adjust.method = \"fdr\",\n  messages = FALSE\n)\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex4_files/figure-html/unnamed-chunk-16-1.png){width=672}\n:::\n:::\n\n\n## 5.2 Subject Preference & Academic Performance\n\n### 5.2.1 Distribution\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(dataset, \n    aes(x = Math, \n        y = Preference_Math)\n  ) +\n  geom_point(\n    alpha = 0.2, \n    size = 7\n  ) +\n  stat_summary(\n    color = \"#fdbf11\", \n    fun = \"median\", \n    geom = \"point\", \n    size = 7, \n    alpha = 0.8\n  ) +\n  scale_x_continuous(\n    expand = expansion(mult = c(0.02, 0)), \n    limits = c(150, 950),\n    breaks = scales::pretty_breaks(n=3)\n  ) +\n  scale_y_discrete(\n    limits = c(NA,\"Strongly Agree\",\"Agree\",\"Disagree\",\"Strongly Disagree\")\n  ) +\n  labs(\n    title = \"Stronger perference in math tend to have a higher math score \",\n    subtitle = \"Median values are highlighted in Yellow\",\n    x = \"Math Score\",\n    y = NULL\n  ) +\n  theme(\n    axis.ticks.y = element_blank(),\n    plot.background = element_rect(fill=\"white\",colour=\"white\")\n  )\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex4_files/figure-html/unnamed-chunk-17-1.png){width=672}\n:::\n:::\n\n\n### 5.2.2 Normality Test\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmodel1 <- lm(Math ~ Preference_Math, data = dataset)\ncheck_n <- check_normality(model1)\nplot(check_n)\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex4_files/figure-html/unnamed-chunk-18-1.png){width=672}\n:::\n:::\n\n\n### 5.2.3 ANOVA\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggbetweenstats(\n  data = dataset,\n  x = Preference_Math, \n  y = Math,\n  type = \"non-parametric\",\n  mean.ci = TRUE, \n  pairwise.comparisons = TRUE, \n  pairwise.display = \"s\",\n  p.adjust.method = \"fdr\",\n  messages = FALSE\n)\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex4_files/figure-html/unnamed-chunk-19-1.png){width=672}\n:::\n:::\n\n\n## 5.3 Academic performance across number of books and gender\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Calculate mean joviality per tile\ngbcols <- c(\"Gender\", \"Books\")\n\n# Calculate Mean joviality score by agegroup and incomegroup and save in new dataframe\nMath_performance <- dataset %>% \n  group_by(\n    across(all_of(gbcols))) %>% \n  # Create new variable for mean joviality score by both groups\n  summarise(\n    mean_math = round(mean(Math),2), \n    .groups = \"drop\") %>%\n  ungroup()\n\n# Style tooltip\ntooltip_css <- \"background-color:#3E4254; font-style:bold; color:#F8F3E6;\" \n\n# Tile Plot\ngg_tile <-\n  ggplot(\n    Math_performance,\n    aes(x = Gender, \n        y = Books)\n  ) +\n  geom_tile_interactive(\n    aes(fill = mean_math,\n        # Format tooltip information\n        tooltip = paste(\"Gender: \", Gender, \"<br>\",\n                        \"Books: \", Books, \"<br>\",\n                        \"Mean Math Score: \", mean_math))\n  ) + \n  # Specify gradient colors for divergent scale \n  scale_fill_gradient(\n    low = \"#0a4c6a\",\n    high = \"#fed1c7\",\n    space = \"Lab\",\n    na.value = \"grey50\",\n    guide = \"colourbar\",\n    aesthetics = \"fill\"\n  ) +  \n labs(\n   title = \"Math Score across Gender and Number of Books\",\n    subtitle = \"Younger People from lower Income Groups had the highest joviality scores\",\n    x = \"Gender\",\n    y = \"Books\"\n  ) +\n  theme(\n    # Move legend to right and change orientation so values are not overlapping \n    legend.position = \"right\",\n    legend.direction = \"vertical\",\n    axis.ticks.y = element_blank(),\n    panel.grid.major.y = element_blank(),\n    text = element_text(family = \"Lato\"),\n    plot.background = element_rect(\n      fill=\"white\",colour=\"white\")\n  ) + \n  scale_y_discrete(\n    limits = c(NA,\"0\",\"1 - 10\",\"11 - 25\",\"26 - 100\", \"101 - 200\", \"201-500\", \">500\"))\n\n# Make into interactive ggiraph object\nggiraph::girafe(ggobj = gg_tile,\n                width_svg = 6,\n                height_svg = 6*0.7,\n                options = list(opts_tooltip(css = tooltip_css)))                   \n```\n\n::: {.cell-output-display}\n```{=html}\n<div class=\"girafe html-widget html-fill-item\" id=\"htmlwidget-2e8226ba91f4d4f6c85d\" style=\"width:100%;height:464px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-2e8226ba91f4d4f6c85d\">{\"x\":{\"html\":\"<?xml version=\\\"1.0\\\" encoding=\\\"UTF-8\\\"?>\\n<svg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' class='ggiraph-svg' role='img' id='svg_60e63bea_92a9_41e2_91f9_a3d016c39b54' viewBox='0 0 432 302.4'>\\n <defs id='svg_60e63bea_92a9_41e2_91f9_a3d016c39b54_defs'>\\n  <clipPath id='svg_60e63bea_92a9_41e2_91f9_a3d016c39b54_c1'>\\n   <rect x='0' y='0' width='432' height='302.4'/>\\n  <\\/clipPath>\\n  <clipPath id='svg_60e63bea_92a9_41e2_91f9_a3d016c39b54_c2'>\\n   <rect x='60.55' y='38.85' width='285.94' height='232.05'/>\\n  <\\/clipPath>\\n <\\/defs>\\n <g id='svg_60e63bea_92a9_41e2_91f9_a3d016c39b54_rootg' class='ggiraph-svg-rootg'>\\n  <g clip-path='url(#svg_60e63bea_92a9_41e2_91f9_a3d016c39b54_c1)'>\\n   <rect x='0' y='0' width='432' height='302.4' fill='#FFFFFF' fill-opacity='1' stroke='#FFFFFF' stroke-opacity='1' stroke-width='0.75' stroke-linejoin='round' stroke-linecap='round' class='ggiraph-svg-bg'/>\\n   <rect x='0' y='0' width='432' height='302.4' fill='#FFFFFF' fill-opacity='1' stroke='#FFFFFF' stroke-opacity='1' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='round'/>\\n  <\\/g>\\n  <g clip-path='url(#svg_60e63bea_92a9_41e2_91f9_a3d016c39b54_c2)'>\\n   <rect x='60.55' y='38.85' width='285.94' height='232.05' fill='#EBEBEB' fill-opacity='1' stroke='none'/>\\n   <polyline points='138.53,270.90 138.53,38.85' fill='none' stroke='#FFFFFF' stroke-opacity='1' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='268.51,270.90 268.51,38.85' fill='none' stroke='#FFFFFF' stroke-opacity='1' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <rect id='svg_60e63bea_92a9_41e2_91f9_a3d016c39b54_e1' x='73.55' y='211.48' width='129.97' height='28.3' fill='#1B506D' fill-opacity='1' stroke='none' title='Gender:  Female &amp;lt;br&amp;gt; Books:  0 &amp;lt;br&amp;gt; Mean Math Score:  479.55'/>\\n   <rect id='svg_60e63bea_92a9_41e2_91f9_a3d016c39b54_e2' x='73.55' y='183.18' width='129.97' height='28.3' fill='#50687E' fill-opacity='1' stroke='none' title='Gender:  Female &amp;lt;br&amp;gt; Books:  1 - 10 &amp;lt;br&amp;gt; Mean Math Score:  509.09'/>\\n   <rect id='svg_60e63bea_92a9_41e2_91f9_a3d016c39b54_e3' x='73.55' y='98.28' width='129.97' height='28.3' fill='#D1B5B4' fill-opacity='1' stroke='none' title='Gender:  Female &amp;lt;br&amp;gt; Books:  101 - 200 &amp;lt;br&amp;gt; Mean Math Score:  599.35'/>\\n   <rect id='svg_60e63bea_92a9_41e2_91f9_a3d016c39b54_e4' x='73.55' y='154.88' width='129.97' height='28.3' fill='#7D8190' fill-opacity='1' stroke='none' title='Gender:  Female &amp;lt;br&amp;gt; Books:  11 - 25 &amp;lt;br&amp;gt; Mean Math Score:  540.4'/>\\n   <rect id='svg_60e63bea_92a9_41e2_91f9_a3d016c39b54_e5' x='73.55' y='69.98' width='129.97' height='28.3' fill='#EFC7C1' fill-opacity='1' stroke='none' title='Gender:  Female &amp;lt;br&amp;gt; Books:  201-500 &amp;lt;br&amp;gt; Mean Math Score:  620.35'/>\\n   <rect id='svg_60e63bea_92a9_41e2_91f9_a3d016c39b54_e6' x='73.55' y='126.58' width='129.97' height='28.3' fill='#BBA7AA' fill-opacity='1' stroke='none' title='Gender:  Female &amp;lt;br&amp;gt; Books:  26 - 100 &amp;lt;br&amp;gt; Mean Math Score:  583.91'/>\\n   <rect id='svg_60e63bea_92a9_41e2_91f9_a3d016c39b54_e7' x='73.55' y='41.68' width='129.97' height='28.3' fill='#C3ACAE' fill-opacity='1' stroke='none' title='Gender:  Female &amp;lt;br&amp;gt; Books:  &amp;gt;500 &amp;lt;br&amp;gt; Mean Math Score:  589.57'/>\\n   <rect id='svg_60e63bea_92a9_41e2_91f9_a3d016c39b54_e8' x='73.55' y='239.77' width='129.97' height='28.3' fill='#134E6B' fill-opacity='1' stroke='none' title='Gender:  Female &amp;lt;br&amp;gt; Books:  NA &amp;lt;br&amp;gt; Mean Math Score:  476.69'/>\\n   <rect id='svg_60e63bea_92a9_41e2_91f9_a3d016c39b54_e9' x='203.52' y='211.48' width='129.97' height='28.3' fill='#295571' fill-opacity='1' stroke='none' title='Gender:  Male &amp;lt;br&amp;gt; Books:  0 &amp;lt;br&amp;gt; Mean Math Score:  485.7'/>\\n   <rect id='svg_60e63bea_92a9_41e2_91f9_a3d016c39b54_e10' x='203.52' y='183.18' width='129.97' height='28.3' fill='#697588' fill-opacity='1' stroke='none' title='Gender:  Male &amp;lt;br&amp;gt; Books:  1 - 10 &amp;lt;br&amp;gt; Mean Math Score:  525.84'/>\\n   <rect id='svg_60e63bea_92a9_41e2_91f9_a3d016c39b54_e11' x='203.52' y='98.28' width='129.97' height='28.3' fill='#E6C2BD' fill-opacity='1' stroke='none' title='Gender:  Male &amp;lt;br&amp;gt; Books:  101 - 200 &amp;lt;br&amp;gt; Mean Math Score:  614.22'/>\\n   <rect id='svg_60e63bea_92a9_41e2_91f9_a3d016c39b54_e12' x='203.52' y='154.88' width='129.97' height='28.3' fill='#8E8B97' fill-opacity='1' stroke='none' title='Gender:  Male &amp;lt;br&amp;gt; Books:  11 - 25 &amp;lt;br&amp;gt; Mean Math Score:  552.27'/>\\n   <rect id='svg_60e63bea_92a9_41e2_91f9_a3d016c39b54_e13' x='203.52' y='69.98' width='129.97' height='28.3' fill='#FED1C7' fill-opacity='1' stroke='none' title='Gender:  Male &amp;lt;br&amp;gt; Books:  201-500 &amp;lt;br&amp;gt; Mean Math Score:  630.81'/>\\n   <rect id='svg_60e63bea_92a9_41e2_91f9_a3d016c39b54_e14' x='203.52' y='126.58' width='129.97' height='28.3' fill='#CCB2B2' fill-opacity='1' stroke='none' title='Gender:  Male &amp;lt;br&amp;gt; Books:  26 - 100 &amp;lt;br&amp;gt; Mean Math Score:  596.05'/>\\n   <rect id='svg_60e63bea_92a9_41e2_91f9_a3d016c39b54_e15' x='203.52' y='41.68' width='129.97' height='28.3' fill='#CBB1B2' fill-opacity='1' stroke='none' title='Gender:  Male &amp;lt;br&amp;gt; Books:  &amp;gt;500 &amp;lt;br&amp;gt; Mean Math Score:  595.66'/>\\n   <rect id='svg_60e63bea_92a9_41e2_91f9_a3d016c39b54_e16' x='203.52' y='239.77' width='129.97' height='28.3' fill='#0A4C6A' fill-opacity='1' stroke='none' title='Gender:  Male &amp;lt;br&amp;gt; Books:  NA &amp;lt;br&amp;gt; Mean Math Score:  474.4'/>\\n  <\\/g>\\n  <g clip-path='url(#svg_60e63bea_92a9_41e2_91f9_a3d016c39b54_c1)'>\\n   <text x='43.4' y='257.07' font-size='6.6pt' font-family='Lato' fill='#4D4D4D' fill-opacity='1'>NA<\\/text>\\n   <text x='50.72' y='228.78' font-size='6.6pt' font-family='Lato' fill='#4D4D4D' fill-opacity='1'>0<\\/text>\\n   <text x='33.1' y='200.48' font-size='6.6pt' font-family='Lato' fill='#4D4D4D' fill-opacity='1'>1 - 10<\\/text>\\n   <text x='28.86' y='172.18' font-size='6.6pt' font-family='Lato' fill='#4D4D4D' fill-opacity='1'>11 - 25<\\/text>\\n   <text x='23.31' y='143.88' font-size='6.6pt' font-family='Lato' fill='#4D4D4D' fill-opacity='1'>26 - 100<\\/text>\\n   <text x='18.41' y='115.58' font-size='6.6pt' font-family='Lato' fill='#4D4D4D' fill-opacity='1'>101 - 200<\\/text>\\n   <text x='23.31' y='87.28' font-size='6.6pt' font-family='Lato' fill='#4D4D4D' fill-opacity='1'>201-500<\\/text>\\n   <text x='35.79' y='58.98' font-size='6.6pt' font-family='Lato' fill='#4D4D4D' fill-opacity='1'>&gt;500<\\/text>\\n   <polyline points='138.53,273.64 138.53,270.90' fill='none' stroke='#333333' stroke-opacity='1' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='268.51,273.64 268.51,270.90' fill='none' stroke='#333333' stroke-opacity='1' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <text x='123.86' y='282.14' font-size='6.6pt' font-family='Lato' fill='#4D4D4D' fill-opacity='1'>Female<\\/text>\\n   <text x='258.97' y='282.14' font-size='6.6pt' font-family='Lato' fill='#4D4D4D' fill-opacity='1'>Male<\\/text>\\n   <text x='185.17' y='294.6' font-size='8.25pt' font-family='Lato'>Gender<\\/text>\\n   <text transform='translate(13.36,170.17) rotate(-90.00)' font-size='8.25pt' font-family='Lato'>Books<\\/text>\\n   <rect x='357.45' y='98.36' width='69.07' height='113.03' fill='#FFFFFF' fill-opacity='1' stroke='none'/>\\n   <text x='362.93' y='112.88' font-size='8.25pt' font-family='Lato'>mean_math<\\/text>\\n   <image x='362.93' y='119.52' width='17.28' height='86.4' preserveAspectRatio='none' xlink:href='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAEsCAYAAAACUNnVAAAAm0lEQVQ4jbWUURKAIAhE33D/e/XdhaQPy8YCgpr+VGDdXVDauqgoIKqK0Fcgiu4rRlRHlBENzgw8QJjh97MJ/u3lMwAzl9LlgRFVfhlffKgk3VjqBS/rxh90fTdMahHdF+ZUFPkCLUXlfuRbFo9PfQQ+vJ6EJQmLE59HOGbus3JF3xhYoI8kXdArnpvyXNGMlIax7clHRTu3R8oG407RJQxWkrEAAAAASUVORK5CYII=' xmlns:xlink='http://www.w3.org/1999/xlink'/>\\n   <polyline points='376.75,202.69 380.21,202.69' fill='none' stroke='#FFFFFF' stroke-opacity='1' stroke-width='0.37' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='376.75,180.67 380.21,180.67' fill='none' stroke='#FFFFFF' stroke-opacity='1' stroke-width='0.37' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='376.75,158.64 380.21,158.64' fill='none' stroke='#FFFFFF' stroke-opacity='1' stroke-width='0.37' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='376.75,136.62 380.21,136.62' fill='none' stroke='#FFFFFF' stroke-opacity='1' stroke-width='0.37' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='366.39,202.69 362.93,202.69' fill='none' stroke='#FFFFFF' stroke-opacity='1' stroke-width='0.37' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='366.39,180.67 362.93,180.67' fill='none' stroke='#FFFFFF' stroke-opacity='1' stroke-width='0.37' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='366.39,158.64 362.93,158.64' fill='none' stroke='#FFFFFF' stroke-opacity='1' stroke-width='0.37' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <polyline points='366.39,136.62 362.93,136.62' fill='none' stroke='#FFFFFF' stroke-opacity='1' stroke-width='0.37' stroke-linejoin='round' stroke-linecap='butt'/>\\n   <text x='385.69' y='205.84' font-size='6.6pt' font-family='Lato'>480<\\/text>\\n   <text x='385.69' y='183.82' font-size='6.6pt' font-family='Lato'>520<\\/text>\\n   <text x='385.69' y='161.79' font-size='6.6pt' font-family='Lato'>560<\\/text>\\n   <text x='385.69' y='139.77' font-size='6.6pt' font-family='Lato'>600<\\/text>\\n   <text x='60.55' y='31.05' font-size='8.25pt' font-family='Lato'>Younger People from lower Income Groups had the highest joviality scores<\\/text>\\n   <text x='60.55' y='14.93' font-size='9.9pt' font-family='Lato'>Math Score across Gender and Number of Books<\\/text>\\n  <\\/g>\\n <\\/g>\\n<\\/svg>\",\"js\":null,\"uid\":\"svg_60e63bea_92a9_41e2_91f9_a3d016c39b54\",\"ratio\":1.428571428571429,\"settings\":{\"tooltip\":{\"css\":\".tooltip_SVGID_ { background-color:#3E4254; font-style:bold; color:#F8F3E6; ; position:absolute;pointer-events:none;z-index:999;}\",\"placement\":\"doc\",\"opacity\":0.9,\"offx\":10,\"offy\":0,\"use_cursor_pos\":true,\"use_fill\":false,\"use_stroke\":false,\"delay_over\":200,\"delay_out\":500},\"hover\":{\"css\":\".hover_data_SVGID_ { fill:orange;stroke:black;cursor:pointer; }\\ntext.hover_data_SVGID_ { stroke:none;fill:orange; }\\ncircle.hover_data_SVGID_ { fill:orange;stroke:black; }\\nline.hover_data_SVGID_, polyline.hover_data_SVGID_ { fill:none;stroke:orange; }\\nrect.hover_data_SVGID_, polygon.hover_data_SVGID_, path.hover_data_SVGID_ { fill:orange;stroke:none; }\\nimage.hover_data_SVGID_ { stroke:orange; }\",\"reactive\":true,\"nearest_distance\":null},\"hover_inv\":{\"css\":\"\"},\"hover_key\":{\"css\":\".hover_key_SVGID_ { fill:orange;stroke:black;cursor:pointer; }\\ntext.hover_key_SVGID_ { stroke:none;fill:orange; }\\ncircle.hover_key_SVGID_ { fill:orange;stroke:black; }\\nline.hover_key_SVGID_, polyline.hover_key_SVGID_ { fill:none;stroke:orange; }\\nrect.hover_key_SVGID_, polygon.hover_key_SVGID_, path.hover_key_SVGID_ { fill:orange;stroke:none; }\\nimage.hover_key_SVGID_ { stroke:orange; }\",\"reactive\":true},\"hover_theme\":{\"css\":\".hover_theme_SVGID_ { fill:orange;stroke:black;cursor:pointer; }\\ntext.hover_theme_SVGID_ { stroke:none;fill:orange; }\\ncircle.hover_theme_SVGID_ { fill:orange;stroke:black; }\\nline.hover_theme_SVGID_, polyline.hover_theme_SVGID_ { fill:none;stroke:orange; }\\nrect.hover_theme_SVGID_, polygon.hover_theme_SVGID_, path.hover_theme_SVGID_ { fill:orange;stroke:none; }\\nimage.hover_theme_SVGID_ { stroke:orange; }\",\"reactive\":true},\"select\":{\"css\":\".select_data_SVGID_ { fill:red;stroke:black;cursor:pointer; }\\ntext.select_data_SVGID_ { stroke:none;fill:red; }\\ncircle.select_data_SVGID_ { fill:red;stroke:black; }\\nline.select_data_SVGID_, polyline.select_data_SVGID_ { fill:none;stroke:red; }\\nrect.select_data_SVGID_, polygon.select_data_SVGID_, path.select_data_SVGID_ { fill:red;stroke:none; }\\nimage.select_data_SVGID_ { stroke:red; }\",\"type\":\"multiple\",\"only_shiny\":true,\"selected\":[]},\"select_inv\":{\"css\":\"\"},\"select_key\":{\"css\":\".select_key_SVGID_ { fill:red;stroke:black;cursor:pointer; }\\ntext.select_key_SVGID_ { stroke:none;fill:red; }\\ncircle.select_key_SVGID_ { fill:red;stroke:black; }\\nline.select_key_SVGID_, polyline.select_key_SVGID_ { fill:none;stroke:red; }\\nrect.select_key_SVGID_, polygon.select_key_SVGID_, path.select_key_SVGID_ { fill:red;stroke:none; }\\nimage.select_key_SVGID_ { stroke:red; }\",\"type\":\"single\",\"only_shiny\":true,\"selected\":[]},\"select_theme\":{\"css\":\".select_theme_SVGID_ { fill:red;stroke:black;cursor:pointer; }\\ntext.select_theme_SVGID_ { stroke:none;fill:red; }\\ncircle.select_theme_SVGID_ { fill:red;stroke:black; }\\nline.select_theme_SVGID_, polyline.select_theme_SVGID_ { fill:none;stroke:red; }\\nrect.select_theme_SVGID_, polygon.select_theme_SVGID_, path.select_theme_SVGID_ { fill:red;stroke:none; }\\nimage.select_theme_SVGID_ { stroke:red; }\",\"type\":\"single\",\"only_shiny\":true,\"selected\":[]},\"zoom\":{\"min\":1,\"max\":1,\"duration\":300},\"toolbar\":{\"position\":\"topright\",\"pngname\":\"diagram\",\"tooltips\":null,\"hidden\":[],\"delay_over\":200,\"delay_out\":500},\"sizing\":{\"rescale\":true,\"width\":1}}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n\n## 5.3 Academic performance across number of books and gender\n\n## 5.4 Time of Exercise and Academic performance\n\n\n::: {.cell}\n\n```{.r .cell-code}\nchr_exercise <- as.character(dataset$Exercise)\nggplot(\n    dataset, \n    aes(x = Math, \n        y = chr_exercise ,\n        fill = chr_exercise,\n        color = chr_exercise)\n  ) +\n  geom_density_ridges(\n    # Adjust bandwidth to reveal variations \n    bandwidth = 15,\n    alpha = .6\n  ) +\n  labs(\n    title = \"Distribution of Math Score Across Time Length Spend on Math Homework\"\n  ) +\n  theme(\n    legend.position = \"none\",\n    axis.title.y = element_blank(),\n    panel.grid.major = element_blank(),\n    plot.background = element_rect(fill=\"white\",colour=\"white\")\n  )\n```\n:::\n",
    "supporting": [
      "Take-home_Ex4_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../../site_libs/htmlwidgets-1.6.4/htmlwidgets.js\"></script>\r\n<script src=\"../../site_libs/d3-bundle-5.16.0/d3-bundle.min.js\"></script>\r\n<script src=\"../../site_libs/d3-lasso-0.0.5/d3-lasso.min.js\"></script>\r\n<script src=\"../../site_libs/save-svg-as-png-1.4.17/save-svg-as-png.min.js\"></script>\r\n<script src=\"../../site_libs/flatbush-4.0.0/flatbush.min.js\"></script>\r\n<link href=\"../../site_libs/ggiraphjs-0.4.6/ggiraphjs.min.css\" rel=\"stylesheet\" />\r\n<script src=\"../../site_libs/ggiraphjs-0.4.6/ggiraphjs.min.js\"></script>\r\n<script src=\"../../site_libs/girafe-binding-0.8.8/girafe.js\"></script>\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}